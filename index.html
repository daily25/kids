<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0d0d0d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Track your kids' daily tasks and pocket money">

    <title>Kids Tasks</title>

    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/png" href="assets/olive.png">
    <link rel="apple-touch-icon" href="assets/olive.png">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div id="app">
        <!-- Header -->
        <header class="app-header">
            <button class="header-btn" id="settingsBtn" aria-label="Settings">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                    </path>
                </svg>
            </button>
            <h1 class="app-title" id="homeBtn" style="cursor:pointer"><span class="title-accent">Kids</span>Tasks</h1>
            <span class="app-version">v0.27</span>
            <div class="header-right">
                <button class="header-btn" id="bonusPointsBtn" aria-label="Add/Remove Points" title="Add/Remove Points">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polygon
                            points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2">
                        </polygon>
                    </svg>
                </button>
                <button class="header-btn" id="addTaskBtn" aria-label="Add Task">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Points & Money Summary (hidden on dashboard) -->
        <div class="summary-bar" id="summaryBar" style="display:none;">
            <div class="summary-item">
                <span class="summary-label">Points</span>
                <span class="summary-value" id="totalPoints">0/0</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">This Week</span>
                <span class="summary-value money" id="weeklyMoney">$0.00</span>
            </div>
        </div>

        <!-- Day Headers (hidden on dashboard) -->
        <div class="day-headers" id="dayHeaders" style="display:none;">
            <!-- Generated by JS -->
        </div>

        <!-- Task List -->
        <main class="task-list" id="taskList">
            <!-- Tasks will be rendered here -->
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav" id="bottomNav">
            <button class="nav-item" data-kid="olive">
                <img src="assets/olive.png" alt="Oliver" class="nav-avatar">
                <span class="nav-name">Oliver</span>
                <span class="nav-money" id="oliveMoney">$50</span>
            </button>
            <button class="nav-item" data-kid="miles">
                <img src="assets/miles.png" alt="Miles" class="nav-avatar">
                <span class="nav-name">Miles</span>
                <span class="nav-money" id="milesMoney">$30</span>
            </button>
            <button class="nav-item" data-kid="zander">
                <img src="assets/zander.png" alt="Zander" class="nav-avatar">
                <span class="nav-name">Zander</span>
                <span class="nav-money" id="zanderMoney">$20</span>
            </button>
        </nav>
    </div>

    <!-- Add/Edit Task Modal -->
    <div class="modal-overlay" id="taskModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modalTitle">Add Task</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <form id="taskForm">
                <input type="hidden" id="taskId">
                <div class="form-group">
                    <label for="taskName">Task Name</label>
                    <input type="text" id="taskName" placeholder="e.g., Brush teeth" required>
                </div>
                <div class="form-group">
                    <label for="taskPoints">Points</label>
                    <input type="number" id="taskPoints" min="1" max="100" value="1" required>
                </div>
                <div class="form-group">
                    <label>Icon</label>
                    <div class="icon-picker" id="iconPicker">
                        <button type="button" class="icon-option selected" data-icon="ü¶∑">ü¶∑</button>
                        <button type="button" class="icon-option" data-icon="üìö">üìö</button>
                        <button type="button" class="icon-option" data-icon="üßÆ">üßÆ</button>
                        <button type="button" class="icon-option" data-icon="üèÉ">üèÉ</button>
                        <button type="button" class="icon-option" data-icon="üõèÔ∏è">üõèÔ∏è</button>
                        <button type="button" class="icon-option" data-icon="üçΩÔ∏è">üçΩÔ∏è</button>
                        <button type="button" class="icon-option" data-icon="üéπ">üéπ</button>
                        <button type="button" class="icon-option" data-icon="‚úèÔ∏è">‚úèÔ∏è</button>
                        <button type="button" class="icon-option" data-icon="üé®">üé®</button>
                        <button type="button" class="icon-option" data-icon="üßπ">üßπ</button>
                        <button type="button" class="icon-option" data-icon="üêï">üêï</button>
                        <button type="button" class="icon-option" data-icon="üíä">üíä</button>
                        <button type="button" class="icon-option" data-icon="üßò">üßò</button>
                        <button type="button" class="icon-option" data-icon="‚ûó">‚ûó</button>
                        <button type="button" class="icon-option" data-icon="üìñ">üìñ</button>
                        <button type="button" class="icon-option" data-icon="‚úçÔ∏è">‚úçÔ∏è</button>
                        <button type="button" class="icon-option" data-icon="ü¶Å">ü¶Å</button>
                        <button type="button" class="icon-option" data-icon="ü•ö">ü•ö</button>
                        <button type="button" class="icon-option" data-icon="üöø">üöø</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Color</label>
                    <div class="color-picker" id="colorPicker">
                        <button type="button" class="color-option selected" data-color="#4ade80"
                            style="background:#4ade80"></button>
                        <button type="button" class="color-option" data-color="#fbbf24"
                            style="background:#fbbf24"></button>
                        <button type="button" class="color-option" data-color="#f87171"
                            style="background:#f87171"></button>
                        <button type="button" class="color-option" data-color="#60a5fa"
                            style="background:#60a5fa"></button>
                        <button type="button" class="color-option" data-color="#a855f7"
                            style="background:#a855f7"></button>
                        <button type="button" class="color-option" data-color="#fb7185"
                            style="background:#fb7185"></button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Active Days</label>
                    <div class="day-selector" id="daySelector">
                        <button type="button" class="day-btn selected" data-day="1">Mon</button>
                        <button type="button" class="day-btn selected" data-day="2">Tue</button>
                        <button type="button" class="day-btn selected" data-day="3">Wed</button>
                        <button type="button" class="day-btn selected" data-day="4">Thu</button>
                        <button type="button" class="day-btn selected" data-day="5">Fri</button>
                        <button type="button" class="day-btn selected" data-day="6">Sat</button>
                        <button type="button" class="day-btn selected" data-day="0">Sun</button>
                    </div>
                </div>
                <div class="form-group" id="kidSelectorGroup">
                    <label>Assign to Kids</label>
                    <div class="kid-selector" id="kidSelector">
                        <label class="kid-checkbox">
                            <input type="checkbox" name="kidSelect" value="olive" checked>
                            <img src="assets/olive.png" alt="Oliver" class="kid-checkbox-avatar">
                            <span>Oliver</span>
                        </label>
                        <label class="kid-checkbox">
                            <input type="checkbox" name="kidSelect" value="miles" checked>
                            <img src="assets/miles.png" alt="Miles" class="kid-checkbox-avatar">
                            <span>Miles</span>
                        </label>
                        <label class="kid-checkbox">
                            <input type="checkbox" name="kidSelect" value="zander" checked>
                            <img src="assets/zander.png" alt="Zander" class="kid-checkbox-avatar">
                            <span>Zander</span>
                        </label>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-danger" id="deleteTaskBtn" style="display:none">Delete</button>
                    <button type="submit" class="btn btn-primary">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="settingsClose">&times;</button>
            </div>
            <div class="settings-content">
                <div class="settings-section">
                    <h3>Weekly Allowance</h3>
                    <div class="form-group">
                        <label for="oliveAllowance">Oliver's Max</label>
                        <div class="input-with-prefix">
                            <span>$</span>
                            <input type="number" id="oliveAllowance" min="0" max="500" value="50">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="milesAllowance">Miles's Max</label>
                        <div class="input-with-prefix">
                            <span>$</span>
                            <input type="number" id="milesAllowance" min="0" max="500" value="30">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="zanderAllowance">Zander's Max</label>
                        <div class="input-with-prefix">
                            <span>$</span>
                            <input type="number" id="zanderAllowance" min="0" max="500" value="20">
                        </div>
                    </div>
                </div>
                <div class="settings-section">
                    <h3>Week Management</h3>
                    <button class="btn btn-warning" id="newWeekBtn">Start New Week</button>
                    <p class="settings-hint">This will reset all task completions for the current week.</p>
                </div>
                <div class="settings-section">
                    <h3>Data Backup</h3>
                    <div class="backup-buttons">
                        <button class="btn btn-primary" id="exportDataBtn">üì• Export Data</button>
                        <button class="btn btn-primary" id="importDataBtn">üì§ Import Data</button>
                    </div>
                    <input type="file" id="importFileInput" accept=".json" style="display:none">
                    <p class="settings-hint">Export saves all tasks, completions, and points to a file. Import restores
                        from a backup.</p>
                </div>
                <div class="settings-section">
                    <h3>App Updates</h3>
                    <button class="btn btn-primary" id="updateAppBtn">üîÑ Check for Updates</button>
                    <p class="settings-hint">Force refresh the app to get the latest version.</p>
                </div>
                <div class="settings-section">
                    <button class="btn btn-primary" id="saveSettingsBtn">Save Settings</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Day View Modal -->
    <div class="modal-overlay" id="dayViewModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="dayViewTitle">Today's Tasks</h2>
                <button class="modal-close" id="dayViewClose">&times;</button>
            </div>
            <div class="day-view-content" id="dayViewContent">
                <!-- Day tasks will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Bonus/Penalty Points Modal -->
    <div class="modal-overlay" id="pointsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Add/Remove Points</h2>
                <button class="modal-close" id="pointsModalClose">&times;</button>
            </div>
            <form id="pointsForm">
                <div class="form-group">
                    <label>Select Child</label>
                    <div class="kid-selector single-select" id="pointsKidSelector">
                        <label class="kid-checkbox">
                            <input type="radio" name="pointsKid" value="olive" checked>
                            <img src="assets/olive.png" alt="Oliver" class="kid-checkbox-avatar">
                            <span>Oliver</span>
                        </label>
                        <label class="kid-checkbox">
                            <input type="radio" name="pointsKid" value="miles">
                            <img src="assets/miles.png" alt="Miles" class="kid-checkbox-avatar">
                            <span>Miles</span>
                        </label>
                        <label class="kid-checkbox">
                            <input type="radio" name="pointsKid" value="zander">
                            <img src="assets/zander.png" alt="Zander" class="kid-checkbox-avatar">
                            <span>Zander</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <div class="points-type-selector">
                        <button type="button" class="points-type-btn active" data-type="bonus">
                            <span class="points-type-icon">‚≠ê</span>
                            <span>Bonus</span>
                        </button>
                        <button type="button" class="points-type-btn" data-type="penalty">
                            <span class="points-type-icon">‚ö†Ô∏è</span>
                            <span>Penalty</span>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="pointsAmount">Points</label>
                    <input type="number" id="pointsAmount" min="1" max="100" value="1" required>
                </div>
                <div class="form-group">
                    <label for="pointsReason">Reason</label>
                    <input type="text" id="pointsReason" placeholder="e.g., Helped with groceries" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="savePointsBtn">Save</button>
                </div>
            </form>

            <!-- Recent adjustments log -->
            <div class="points-log" id="pointsLog">
                <h3>Recent Adjustments</h3>
                <div class="points-log-list" id="pointsLogList">
                    <!-- Will be populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <script src="js/storage.js?v=3"></script>
    <script src="js/components.js?v=3"></script>
    <script src="js/app.js?v=3"></script>
</body>

</html>